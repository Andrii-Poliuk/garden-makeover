import{T as m,U as N,r as B,F as P,E as h,a as H,e as u,C as L}from"./index-Dgw_hsna.js";import"./webworkerAll-DcB9wlZv.js";class R{constructor(e){this._lastTransform="",this._observer=null,this._tickerAttached=!1,this.updateTranslation=()=>{if(!this._canvas)return;const i=this._canvas.getBoundingClientRect(),t=this._canvas.width,s=this._canvas.height,n=i.width/t*this._renderer.resolution,r=i.height/s*this._renderer.resolution,a=i.left,c=i.top,_=`translate(${a}px, ${c}px) scale(${n}, ${r})`;_!==this._lastTransform&&(this._domElement.style.transform=_,this._lastTransform=_)},this._domElement=e.domElement,this._renderer=e.renderer,!(globalThis.OffscreenCanvas&&this._renderer.canvas instanceof OffscreenCanvas)&&(this._canvas=this._renderer.canvas,this._attachObserver())}get canvas(){return this._canvas}ensureAttached(){!this._domElement.parentNode&&this._canvas.parentNode&&(this._canvas.parentNode.appendChild(this._domElement),this.updateTranslation())}_attachObserver(){"ResizeObserver"in globalThis?(this._observer&&(this._observer.disconnect(),this._observer=null),this._observer=new ResizeObserver(e=>{for(const i of e){if(i.target!==this._canvas)continue;const t=this.canvas.width,s=this.canvas.height,n=i.contentRect.width/t*this._renderer.resolution,r=i.contentRect.height/s*this._renderer.resolution;(this._lastScaleX!==n||this._lastScaleY!==r)&&(this.updateTranslation(),this._lastScaleX=n,this._lastScaleY=r)}}),this._observer.observe(this._canvas)):this._tickerAttached||m.shared.add(this.updateTranslation,this,N.HIGH)}destroy(){this._observer?(this._observer.disconnect(),this._observer=null):this._tickerAttached&&m.shared.remove(this.updateTranslation),this._domElement=null,this._renderer=null,this._canvas=null,this._tickerAttached=!1,this._lastTransform="",this._lastScaleX=null,this._lastScaleY=null}}var b=/iPhone/i,y=/iPod/i,g=/iPad/i,O=/\biOS-universal(?:.+)Mac\b/i,p=/\bAndroid(?:.+)Mobile\b/i,E=/Android/i,d=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,v=/Silk/i,l=/Windows Phone/i,T=/\bWindows(?:.+)ARM\b/i,x=/BlackBerry/i,w=/BB10/i,A=/Opera Mini/i,M=/\b(CriOS|Chrome)(?:.+)Mobile/i,D=/Mobile(?:.+)Firefox\b/i,C=function(o){return typeof o<"u"&&o.platform==="MacIntel"&&typeof o.maxTouchPoints=="number"&&o.maxTouchPoints>1&&typeof MSStream>"u"};function j(o){return function(e){return e.test(o)}}function k(o){var e={userAgent:"",platform:"",maxTouchPoints:0};!o&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof o=="string"?e.userAgent=o:o&&o.userAgent&&(e={userAgent:o.userAgent,platform:o.platform,maxTouchPoints:o.maxTouchPoints||0});var i=e.userAgent,t=i.split("[FBAN");typeof t[1]<"u"&&(i=t[0]),t=i.split("Twitter"),typeof t[1]<"u"&&(i=t[0]);var s=j(i),n={apple:{phone:s(b)&&!s(l),ipod:s(y),tablet:!s(b)&&(s(g)||C(e))&&!s(l),universal:s(O),device:(s(b)||s(y)||s(g)||s(O)||C(e))&&!s(l)},amazon:{phone:s(d),tablet:!s(d)&&s(v),device:s(d)||s(v)},android:{phone:!s(l)&&s(d)||!s(l)&&s(p),tablet:!s(l)&&!s(d)&&!s(p)&&(s(v)||s(E)),device:!s(l)&&(s(d)||s(v)||s(p)||s(E))||s(/\bokhttp\b/i)},windows:{phone:s(l),tablet:s(T),device:s(l)||s(T)},other:{blackberry:s(x),blackberry10:s(w),opera:s(A),firefox:s(D),chrome:s(M),device:s(x)||s(w)||s(A)||s(D)||s(M)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const K=k.default??k,z=K(globalThis.navigator),W=9,I=100,V=0,X=0,S=2,$=1,Y=-1e3,G=-1e3,Z=2,f=class U{constructor(e,i=z){this._mobileInfo=i,this.debug=!1,this._activateOnTab=!0,this._deactivateOnMouseMove=!0,this._isActive=!1,this._isMobileAccessibility=!1,this._div=null,this._pools={},this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._isRunningTests=!1,this._boundOnKeyDown=this._onKeyDown.bind(this),this._boundOnMouseMove=this._onMouseMove.bind(this),this._hookDiv=null,(i.tablet||i.phone)&&this._createTouchHook(),this._renderer=e}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}get div(){return this._div}_createTouchHook(){const e=document.createElement("button");e.style.width=`${$}px`,e.style.height=`${$}px`,e.style.position="absolute",e.style.top=`${Y}px`,e.style.left=`${G}px`,e.style.zIndex=Z.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}_destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}_activate(){if(this._isActive)return;this._isActive=!0,this._div||(this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.top=`${V}px`,this._div.style.left=`${X}px`,this._div.style.pointerEvents="none",this._div.style.zIndex=S.toString(),this._canvasObserver=new R({domElement:this._div,renderer:this._renderer})),this._activateOnTab&&globalThis.addEventListener("keydown",this._boundOnKeyDown,!1),this._deactivateOnMouseMove&&globalThis.document.addEventListener("mousemove",this._boundOnMouseMove,!0);const e=this._renderer.view.canvas;if(e.parentNode)this._canvasObserver.ensureAttached(),this._initAccessibilitySetup();else{const i=new MutationObserver(()=>{e.parentNode&&(i.disconnect(),this._canvasObserver.ensureAttached(),this._initAccessibilitySetup())});i.observe(document.body,{childList:!0,subtree:!0})}}_initAccessibilitySetup(){this._renderer.runners.postrender.add(this),this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered)}_deactivate(){var e,i;if(!(!this._isActive||this._isMobileAccessibility)){this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._boundOnMouseMove,!0),this._activateOnTab&&globalThis.addEventListener("keydown",this._boundOnKeyDown,!1),this._renderer.runners.postrender.remove(this);for(const t of this._children)(e=t._accessibleDiv)!=null&&e.parentNode&&(t._accessibleDiv.parentNode.removeChild(t._accessibleDiv),t._accessibleDiv=null),t._accessibleActive=!1;for(const t in this._pools)this._pools[t].forEach(n=>{n.parentNode&&n.parentNode.removeChild(n)}),delete this._pools[t];(i=this._div)!=null&&i.parentNode&&this._div.parentNode.removeChild(this._div),this._pools={},this._children=[]}}_updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&(e._accessibleActive||this._addChild(e),e._renderId=this._renderId);const i=e.children;if(i)for(let t=0;t<i.length;t++)this._updateAccessibleObjects(i[t])}init(e){const t={accessibilityOptions:{...U.defaultOptions,...(e==null?void 0:e.accessibilityOptions)||{}}};this.debug=t.accessibilityOptions.debug,this._activateOnTab=t.accessibilityOptions.activateOnTab,this._deactivateOnMouseMove=t.accessibilityOptions.deactivateOnMouseMove,t.accessibilityOptions.enabledByDefault&&this._activate(),this._renderer.runners.postrender.remove(this)}postrender(){const e=performance.now();if(this._mobileInfo.android.device&&e<this._androidUpdateCount||(this._androidUpdateCount=e+this._androidUpdateFrequency,(!this._renderer.renderingToScreen||!this._renderer.view.canvas)&&!this._isRunningTests))return;const i=new Set;if(this._renderer.lastObjectRendered){this._updateAccessibleObjects(this._renderer.lastObjectRendered);for(const t of this._children)t._renderId===this._renderId&&i.add(this._children.indexOf(t))}for(let t=this._children.length-1;t>=0;t--){const s=this._children[t];i.has(t)||(s._accessibleDiv&&s._accessibleDiv.parentNode&&(s._accessibleDiv.parentNode.removeChild(s._accessibleDiv),this._getPool(s.accessibleType).push(s._accessibleDiv),s._accessibleDiv=null),s._accessibleActive=!1,B(this._children,t,1))}this._renderer.renderingToScreen&&this._canvasObserver.ensureAttached();for(let t=0;t<this._children.length;t++){const s=this._children[t];if(!s._accessibleActive||!s._accessibleDiv)continue;const n=s._accessibleDiv,r=s.hitArea||s.getBounds().rectangle;if(s.hitArea){const a=s.worldTransform;n.style.left=`${a.tx+r.x*a.a}px`,n.style.top=`${a.ty+r.y*a.d}px`,n.style.width=`${r.width*a.a}px`,n.style.height=`${r.height*a.d}px`}else this._capHitArea(r),n.style.left=`${r.x}px`,n.style.top=`${r.y}px`,n.style.width=`${r.width}px`,n.style.height=`${r.height}px`}this._renderId++}_updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}_capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:i,height:t}=this._renderer;e.x+e.width>i&&(e.width=i-e.x),e.y+e.height>t&&(e.height=t-e.y)}_addChild(e){let t=this._getPool(e.accessibleType).pop();t?(t.innerHTML="",t.removeAttribute("title"),t.removeAttribute("aria-label"),t.tabIndex=0):(e.accessibleType==="button"?t=document.createElement("button"):(t=document.createElement(e.accessibleType),t.style.cssText=`
                        color: transparent;
                        pointer-events: none;
                        padding: 0;
                        margin: 0;
                        border: 0;
                        outline: 0;
                        background: transparent;
                        box-sizing: border-box;
                        user-select: none;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                    `,e.accessibleText&&(t.innerText=e.accessibleText)),t.style.width=`${I}px`,t.style.height=`${I}px`,t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=S.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&e.accessibleTitle!==null?t.title=e.accessibleTitle:(!e.accessibleHint||e.accessibleHint===null)&&(t.title=`container ${e.tabIndex}`),e.accessibleHint&&e.accessibleHint!==null&&t.setAttribute("aria-label",e.accessibleHint),e.interactive?t.tabIndex=e.tabIndex:t.tabIndex=0,this.debug&&this._updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.container=e,this._children.push(e),this._div.appendChild(e._accessibleDiv)}_dispatchEvent(e,i){const{container:t}=e.target,s=this._renderer.events.rootBoundary,n=Object.assign(new P(s),{target:t});s.rootTarget=this._renderer.lastObjectRendered,i.forEach(r=>s.dispatchEvent(n,r))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode!==W||!this._activateOnTab||this._activate()}_onMouseMove(e){e.movementX===0&&e.movementY===0||this._deactivate()}destroy(){var e;this._deactivate(),this._destroyTouchHook(),(e=this._canvasObserver)==null||e.destroy(),this._canvasObserver=null,this._div=null,this._pools=null,this._children=null,this._renderer=null,this._hookDiv=null,globalThis.removeEventListener("keydown",this._boundOnKeyDown),this._boundOnKeyDown=null,globalThis.document.removeEventListener("mousemove",this._boundOnMouseMove,!0),this._boundOnMouseMove=null}setAccessibilityEnabled(e){e?this._activate():this._deactivate()}_getPool(e){return this._pools[e]||(this._pools[e]=[]),this._pools[e]}};f.extension={type:[h.WebGLSystem,h.WebGPUSystem],name:"accessibility"};f.defaultOptions={enabledByDefault:!1,debug:!1,activateOnTab:!0,deactivateOnMouseMove:!0};let q=f;const J={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,accessibleType:"button",accessibleText:null,accessiblePointerEvents:"auto",accessibleChildren:!0,_accessibleActive:!1,_accessibleDiv:null,_renderId:-1};class F{constructor(e){this._attachedDomElements=[],this._renderer=e,this._renderer.runners.postrender.add(this),this._renderer.runners.init.add(this),this._domElement=document.createElement("div"),this._domElement.style.position="absolute",this._domElement.style.top="0",this._domElement.style.left="0",this._domElement.style.pointerEvents="none",this._domElement.style.zIndex="1000"}init(){this._canvasObserver=new R({domElement:this._domElement,renderer:this._renderer})}addRenderable(e,i){this._attachedDomElements.includes(e)||this._attachedDomElements.push(e)}updateRenderable(e){}validateRenderable(e){return!0}postrender(){const e=this._attachedDomElements;if(e.length===0){this._domElement.remove();return}this._canvasObserver.ensureAttached();for(let i=0;i<e.length;i++){const t=e[i],s=t.element;if(!t.parent||t.globalDisplayStatus<7)s==null||s.remove(),e.splice(i,1),i--;else{this._domElement.contains(s)||(s.style.position="absolute",s.style.pointerEvents="auto",this._domElement.appendChild(s));const n=t.worldTransform,r=t._anchor,a=t.width*r.x,c=t.height*r.y;s.style.transformOrigin=`${a}px ${c}px`,s.style.transform=`matrix(${n.a}, ${n.b}, ${n.c}, ${n.d}, ${n.tx-a}, ${n.ty-c})`,s.style.opacity=t.groupAlpha.toString()}}}destroy(){var e;this._renderer.runners.postrender.remove(this);for(let i=0;i<this._attachedDomElements.length;i++)(e=this._attachedDomElements[i].element)==null||e.remove();this._attachedDomElements.length=0,this._domElement.remove(),this._canvasObserver.destroy(),this._renderer=null}}F.extension={type:[h.WebGLPipes,h.WebGPUPipes,h.CanvasPipes],name:"dom"};const Q={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return this.eventMode==="dynamic"||this.eventMode==="static"},set interactive(o){this.eventMode=o?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??H.defaultEventMode},set eventMode(o){this._internalEventMode=o},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(o,e,i){const t=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,s=typeof i=="object"?i.signal:void 0,n=typeof i=="object"?i.once===!0:!1,r=typeof e=="function"?void 0:e;o=t?`${o}capture`:o;const a=typeof e=="function"?e:e.handleEvent,c=this;s&&s.addEventListener("abort",()=>{c.off(o,a,r)}),n?c.once(o,a,r):c.on(o,a,r)},removeEventListener(o,e,i){const t=typeof i=="boolean"&&i||typeof i=="object"&&i.capture,s=typeof e=="function"?void 0:e;o=t?`${o}capture`:o,e=typeof e=="function"?e:e.handleEvent,this.off(o,e,s)},dispatchEvent(o){if(!(o instanceof P))throw new Error("Container cannot propagate events outside of the Federated Events API");return o.defaultPrevented=!1,o.path=null,o.target=this,o.manager.dispatchEvent(o),!o.defaultPrevented}};u.add(q);u.mixin(L,J);u.add(H);u.mixin(L,Q);u.add(F);
